<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>ARTIST THE WINNER</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root{
      --bg:#111827;
      --card:#1f2937;
      --primary:#3b82f6;
      --success:#22c55e;
      --danger:#ef4444;
      --muted:#9ca3af;
      --small:#f87171;
      --big:#4ade80;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Poppins",sans-serif;
      background:linear-gradient(145deg,#0f172a,#1e293b);
      color:#fff;
      padding:16px;
    }
    .panel{
      background:var(--card);
      border-radius:20px;
      padding:18px;
      margin-bottom:18px;
      box-shadow:0 10px 30px rgba(0,0,0,0.5);
    }
    .winner-box{
      text-align:center;
      font-size:14px;
      font-weight:600;
      padding:10px;
      border-radius:14px;
      background:rgba(59,130,246,0.15);
      border:1px solid var(--primary);
      margin-bottom:12px;
    }
    .online-box{
      text-align:center;
      font-size:14px;
      font-weight:600;
      padding:10px;
      border-radius:14px;
      background:rgba(34,197,94,0.15);
      border:1px solid var(--success);
      margin-bottom:16px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .brand img{
      width:58px;height:58px;border-radius:14px;
      box-shadow:0 0 12px rgba(59,130,246,0.4);
    }
    .brand h2{margin:0;font-size:20px;font-weight:800;color:var(--primary)}
    .brand p{margin:4px 0 0;font-size:13px;color:var(--muted)}
    .game-type{
      margin-top:14px;
      text-align:center;
      font-weight:700;
      padding:10px;
      border-radius:12px;
      background:rgba(59,130,246,0.2);
      border:1px solid var(--primary);
    }
    .stage{
      background:var(--card);
      border-radius:20px;
      padding:20px;
      margin-top:16px;
      text-align:center;
    }
    .label{font-size:13px;color:var(--muted)}
    .value{font-size:20px;font-weight:700;margin:4px 0}
    .result{
      font-size:34px;
      font-weight:900;
      margin:12px 0;
      opacity:0;
      animation:fadeInOut 2s ease-in-out infinite;
    }
    .result.big{color:var(--big)}
    .result.small{color:var(--small)}
    @keyframes fadeInOut{
      0%{opacity:0}
      50%{opacity:1}
      100%{opacity:0}
    }
    .toggle-wrapper{
      margin-top:18px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
    }
    .switch{position:relative;display:inline-block;width:60px;height:32px}
    .switch input{opacity:0;width:0;height:0}
    .slider{
      position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;
      background:#374151;transition:.4s;border-radius:34px;
    }
    .slider:before{
      position:absolute;content:"";height:24px;width:24px;
      left:4px;bottom:4px;background:white;transition:.4s;border-radius:50%;
    }
    input:checked + .slider{background:var(--success);}
    input:checked + .slider:before{transform:translateX(28px);}
    .footer-note{margin-top:12px;font-size:13px;font-weight:700;color:#fde047}

    /* Toast */
    .toast{
      position:fixed;bottom:20px;left:50%;
      transform:translateX(-50%) translateY(40px);
      padding:12px 20px;border-radius:10px;
      font-size:14px;font-weight:700;opacity:0;
      transition:all .3s ease;z-index:1000;
    }
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    .toast.success{background:var(--success);color:#000}
    .toast.error{background:var(--danger);color:#fff}

    /* Floating round yellow icon */
    .floating-btn{
      position:fixed;
      bottom:20px;right:20px;
      width:50px;height:50px;
      border-radius:50%;
      background:yellow;
      border:2px solid #000;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
      color:#000;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(0,0,0,0.5);
      z-index:1500;
      user-select:none;
    }

    /* Overlay */
    .overlay {
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.6);
      display:none;align-items:center;justify-content:center;
      z-index:2000;
    }
    .panel-float {
      width:90%;max-width:420px;border-radius:20px;
      background:#fff;color:#000;overflow:hidden;
      animation:fadeIn .3s ease;
    }
    @keyframes fadeIn {from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
    .panel-header{
      display:flex;align-items:center;justify-content:space-between;
      padding:12px 16px;border-bottom:1px solid #eee;background:#f8f8f8;
    }
    .panel-header .logo{display:flex;align-items:center;gap:10px;}
    .panel-header .logo img{width:28px;height:28px;border-radius:6px;}
    .panel-header .logo span{font-weight:700;font-size:15px;}
    .panel-header .close-btn{
      background:#ff3d3d;color:#fff;border:none;width:28px;height:28px;
      border-radius:50%;font-size:16px;cursor:pointer;
    }
    .panel-body{padding:20px;text-align:center;font-size:14px;}
    .countdown{margin-top:10px;font-weight:700;font-size:16px;}
    iframe{width:100%;height:500px;border:none;display:none;}

    /* Hide class */
    .hidden { display: none !important; }
  </style>
</head>
<body>

<div class="panel">
  <div class="winner-box" id="winnerText">UID 1234567 Win ₹4,684</div>
  <div class="online-box" id="onlineUsers"><i class="fa fa-users"></i> Online Users: 190</div>
  <div class="brand">
    <img src="https://i.ibb.co/QvkjzLg6/x.jpg" alt="logo">
    <div>
      <h2>Goa Game Official</h2>
      <p>Prediction King</p>
    </div>
  </div>
  <div class="game-type">WINGO 1MIN</div>
</div>

<div class="panel stage">
  <div class="label hidden" id="periodLabel">Current Period (UTC)</div>
  <div class="value hidden" id="periodNumber">—</div>
  <div class="label hidden" id="timerLabel">Next in <span id="timerText">00:00</span></div>
  <div class="hidden" id="resultBox">
    <div class="label">Result</div>
    <div id="resultText" class="result">PREDICTING...</div>
  </div>
  <div class="toggle-wrapper">
    <div>Activate Server</div>
    <label class="switch">
      <input type="checkbox" id="serverToggle">
      <span class="slider"></span>
    </label>
  </div>
  <div class="footer-note">ARTIST THE WINNER</div>
</div>

<div id="toast" class="toast">Server Activated</div>

<!-- Floating draggable icon -->
<div class="floating-btn" id="floatBtn" title="Create new account">
  <i class="fa fa-user-plus"></i>
</div>

<!-- Overlay -->
<div class="overlay" id="overlay">
  <div class="panel-float">
    <div class="panel-header">
      <div class="logo">
        <img src="https://i.ibb.co/QvkjzLg6/x.jpg" alt="logo">
        <span>Goa Game • Prediction Panel</span>
      </div>
      <button class="close-btn" id="closeBtn">&times;</button>
    </div>
    <div class="panel-body" id="panelBody">
      <div>Please create a new account before continuing.</div>
      <div class="countdown">Redirecting in <span id="counter">3</span> sec...</div>
    </div>
    <iframe id="iframePage"></iframe>
  </div>
</div>

<script>
const winnerText=document.getElementById("winnerText");
const onlineUsers=document.getElementById("onlineUsers");
const timerText=document.getElementById("timerText");
const resultText=document.getElementById("resultText");
const periodNumberEl=document.getElementById("periodNumber");
const toast=document.getElementById("toast");
const serverToggle=document.getElementById("serverToggle");
const periodLabel=document.getElementById("periodLabel");
const timerLabel=document.getElementById("timerLabel");
const resultBox=document.getElementById("resultBox");

let serverActive=false;

// Winner updater
let lastWinner=0;
function updateWinner(t){
  if(!lastWinner||t-lastWinner>2500){
    lastWinner=t;
    const uid=Math.floor(1000000+Math.random()*9000000);
    const amt=Math.floor(Math.random()*14500)+500;
    winnerText.textContent=`UID ${uid} Win ₹${amt.toLocaleString()}`;
  }
  requestAnimationFrame(updateWinner);
}

// Online users updater
let lastUsers=0;
function updateUsers(t){
  if(!lastUsers||t-lastUsers>3000){
    lastUsers=t;
    const u=Math.floor(Math.random()*21)+180;
    onlineUsers.innerHTML=`<i class="fa fa-users"></i> Online Users: ${u}`;
  }
  requestAnimationFrame(updateUsers);
}

// Toast
function showToast(msg,type){
  toast.textContent=msg;
  toast.className="toast show "+type;
  if(navigator.vibrate){navigator.vibrate(200);}
  setTimeout(()=>toast.classList.remove("show"),2000);
}

// Toggle server
serverToggle.addEventListener("change",()=>{
  serverActive=serverToggle.checked;
  if(serverActive){
    periodLabel.classList.remove("hidden");
    periodNumberEl.classList.remove("hidden");
    timerLabel.classList.remove("hidden");
    resultBox.classList.remove("hidden");
    showToast("Server Activated","success");
  }else{
    periodLabel.classList.add("hidden");
    periodNumberEl.classList.add("hidden");
    timerLabel.classList.add("hidden");
    resultBox.classList.add("hidden");
    showToast("Server Deactivated","error");
  }
});

// Period logic
function setResultText(kind){
  resultText.classList.remove("big","small");
  resultText.textContent=kind;
  if(kind==="BIG"){resultText.classList.add("big")}
  if(kind==="SMALL"){resultText.classList.add("small")}
}
function updatePeriod(){
  if(!serverActive) return;
  const now=new Date();
  const year=now.getUTCFullYear();
  const month=String(now.getUTCMonth()+1).padStart(2,'0');
  const day=String(now.getUTCDate()).padStart(2,'0');
  const hours=now.getUTCHours();
  const minutes=now.getUTCMinutes();
  const seconds=now.getUTCSeconds();
  const totalMinutes=hours*60+minutes;
  const periodNum=`${year}${month}${day}1000${10001+totalMinutes}`;
  periodNumberEl.innerText=periodNum;
  const lastTwo=periodNum.slice(-2);
  let sum=lastTwo.split("").map(Number).reduce((a,b)=>a+b,0);
  if(sum>9) sum=String(sum).split("").map(Number).reduce((a,b)=>a+b,0);
  const kind=sum>=5?"BIG":"SMALL";
  const remain=60-seconds;
  timerText.innerText=`00:${String(remain%60).padStart(2,'0')}`;

  if(remain<=59 && remain>=55){
    resultText.textContent="PREDICTING...";
    resultText.style.color="#fde047";
  } else {
    setResultText(kind);
    resultText.style.color="";
  }
}

document.addEventListener("DOMContentLoaded",()=>{
  requestAnimationFrame(updateWinner);
  requestAnimationFrame(updateUsers);
  setInterval(updatePeriod,1000);
});

// Floating icon overlay
const floatBtn=document.getElementById("floatBtn");
const overlay=document.getElementById("overlay");
const closeBtn=document.getElementById("closeBtn");
const counter=document.getElementById("counter");
const iframePage=document.getElementById("iframePage");
const panelBody=document.getElementById("panelBody");

floatBtn.addEventListener("click",()=>{
  overlay.style.display="flex";
  panelBody.style.display="block";
  iframePage.style.display="none";
  let time=3;
  counter.textContent=time;
  let interval=setInterval(()=>{
    time--;
    counter.textContent=time;
    if(time<=0){
      clearInterval(interval);
      panelBody.style.display="none";
      iframePage.style.display="block";
      iframePage.src="https://www.goagames.social/#/register?invitationCode=181357898419";
    }
  },1000);
});

closeBtn.addEventListener("click",()=>{
  overlay.style.display="none";
  iframePage.src="";
});

// Make floating draggable
let drag=false, offsetX, offsetY;
floatBtn.addEventListener("mousedown",e=>{
  drag=true;
  offsetX=e.clientX-floatBtn.getBoundingClientRect().left;
  offsetY=e.clientY-floatBtn.getBoundingClientRect().top;
});
document.addEventListener("mousemove",e=>{
  if(drag){
    floatBtn.style.left=(e.clientX-offsetX)+"px";
    floatBtn.style.top=(e.clientY-offsetY)+"px";
    floatBtn.style.right="auto";
    floatBtn.style.bottom="auto";
  }
});
document.addEventListener("mouseup",()=>drag=false);

// Mobile touch drag
floatBtn.addEventListener("touchstart",e=>{
  drag=true;
  offsetX=e.touches[0].clientX-floatBtn.getBoundingClientRect().left;
  offsetY=e.touches[0].clientY-floatBtn.getBoundingClientRect().top;
});
document.addEventListener("touchmove",e=>{
  if(drag){
    floatBtn.style.left=(e.touches[0].clientX-offsetX)+"px";
    floatBtn.style.top=(e.touches[0].clientY-offsetY)+"px";
    floatBtn.style.right="auto";
    floatBtn.style.bottom="auto";
  }
});
document.addEventListener("touchend",()=>drag=false);
</script>

</body>
</html>
